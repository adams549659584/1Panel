import{d as K,G as Q,r as g,x as M,j as R,Y as x,b as B,h as W,e,w as a,f as N,g as w,t as f,c as A,O as H,U as Z,$ as k,V as q,a1 as ee,a2 as ae,l as oe,m as se,a3 as te,A as le,af as pe,a5 as ne,v as ce,S as fe,aY as we,o as ge,a0 as be,I as ve,J as _e,av as ye,y as C,aJ as J,ap as Pe,X as Y}from"./index-9eeac04e.js";/* empty css                *//* empty css            *//* empty css              *//* empty css                    *//* empty css                     *//* empty css             */import"./form-item-d76e7d20.js";/* empty css              *//* empty css               */import{_ as Ve}from"./layout-content-27c09564.js";import{u as Ce,e as $e,f as X,i as he}from"./setting-f1c3ee2a.js";import{R as b,c as Te}from"./form-rules-028b05ac.js";import{_ as Ne}from"./index-bb4c3e65.js";/* empty css                *//* empty css             */import{b as D}from"./auth-2995b339.js";/* empty css                    *//* empty css             */import"./index-5ffc91ba.js";import"./util-cbaccc93.js";import"./base64-e52cbffd.js";/* empty css            */const Se={class:"dialog-footer"},ke=K({__name:"index",setup(re,{expose:m}){const p=Q(),_=g(),U=M({oldPassword:[b.requiredInput],newPassword:[b.requiredInput,{min:6,message:R.global.t("commons.rule.commonPassword"),trigger:"blur"}],newPasswordComplexity:[b.requiredInput,b.password],retryPassword:[b.requiredInput,{validator:T,trigger:"blur"}]}),P=g(!1),s=g(!1),l=M({oldPassword:"",newPassword:"",newPasswordComplexity:"",retryPassword:""}),V=g(),$=n=>{V.value=n.complexityVerification,l.oldPassword="",l.newPassword="",l.newPasswordComplexity="",l.retryPassword="",s.value=!0};function T(n,r,c){if((V.value==="disable"?l.newPassword:l.newPasswordComplexity)!==l.retryPassword)return c(new Error(R.global.t("commons.rule.rePassword")));c()}const E=async n=>{!n||n.validate(async r=>{if(!r)return;let c=V.value==="disable"?l.newPassword:l.newPasswordComplexity;if(c===l.oldPassword){Z(R.global.t("setting.duplicatePassword"));return}P.value=!0,await Ce({oldPassword:l.oldPassword,newPassword:c}).then(async()=>{P.value=!1,s.value=!1,k(R.global.t("commons.msg.operationSuccess")),await D(),q.push({name:"login",params:{code:""}}),p.setLogStatus(!1)}).catch(()=>{P.value=!1})})},S=()=>{s.value=!1};return m({acceptParams:$}),(n,r)=>{const c=ee,v=ae,F=oe,I=se,L=te,o=le,t=pe,d=ne;return x((B(),W("div",null,[e(t,{modelValue:s.value,"onUpdate:modelValue":r[6]||(r[6]=u=>s.value=u),"destroy-on-close":!0,"close-on-click-modal":!1,size:"50%"},{header:a(()=>[e(Ne,{header:n.$t("setting.changePassword"),back:S},null,8,["header"])]),footer:a(()=>[N("span",Se,[e(o,{disabled:P.value,onClick:r[4]||(r[4]=u=>s.value=!1)},{default:a(()=>[w(f(n.$t("commons.button.cancel")),1)]),_:1},8,["disabled"]),e(o,{disabled:P.value,type:"primary",onClick:r[5]||(r[5]=u=>E(_.value))},{default:a(()=>[w(f(n.$t("commons.button.confirm")),1)]),_:1},8,["disabled"])])]),default:a(()=>[e(L,{ref_key:"passFormRef",ref:_,"label-position":"top",model:l,rules:U},{default:a(()=>[e(I,{type:"flex",justify:"center"},{default:a(()=>[e(F,{span:22},{default:a(()=>[e(v,{label:n.$t("setting.oldPassword"),prop:"oldPassword"},{default:a(()=>[e(c,{type:"password","show-password":"",clearable:"",modelValue:l.oldPassword,"onUpdate:modelValue":r[0]||(r[0]=u=>l.oldPassword=u)},null,8,["modelValue"])]),_:1},8,["label"]),V.value==="disable"?(B(),A(v,{key:0,label:n.$t("setting.newPassword"),prop:"newPassword"},{default:a(()=>[e(c,{type:"password","show-password":"",clearable:"",modelValue:l.newPassword,"onUpdate:modelValue":r[1]||(r[1]=u=>l.newPassword=u)},null,8,["modelValue"])]),_:1},8,["label"])):H("",!0),V.value==="enable"?(B(),A(v,{key:1,label:n.$t("setting.newPassword"),prop:"newPasswordComplexity"},{default:a(()=>[e(c,{type:"password","show-password":"",clearable:"",modelValue:l.newPasswordComplexity,"onUpdate:modelValue":r[2]||(r[2]=u=>l.newPasswordComplexity=u)},null,8,["modelValue"])]),_:1},8,["label"])):H("",!0),e(v,{label:n.$t("setting.retryPassword"),prop:"retryPassword"},{default:a(()=>[e(c,{type:"password","show-password":"",clearable:"",modelValue:l.retryPassword,"onUpdate:modelValue":r[3]||(r[3]=u=>l.retryPassword=u)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])),[[d,P.value]])}}}),Ue=N("br",null,null,-1),Ee={class:"input-help"},Ie={style:{width:"45px"}},oa=K({__name:"index",setup(re){const m=g(!1),p=ce(),_=Q(),U=fe(()=>_.themeConfig),{switchDark:P}=we(),s=M({userName:"",password:"",email:"",sessionTimeout:0,localTime:"",panelName:"",theme:"",language:"",complexityVerification:""}),l=g(),V=g(10),$=g(),T=g(),E=g(),S=async()=>{const o=await $e();s.userName=o.data.userName,s.password="******",s.sessionTimeout=Number(o.data.sessionTimeout),s.localTime=o.data.localTime,s.panelName=o.data.panelName,s.theme=o.data.theme,s.language=o.data.language,s.complexityVerification=o.data.complexityVerification},n=g(),r=()=>{E.value.acceptParams({complexityVerification:s.complexityVerification})},c=async(o,t,d)=>{!o||!await o.validateField("userName",I)||Pe.confirm(p.t("setting.userChangeHelper"),p.t("setting.userChange"),{confirmButtonText:p.t("commons.button.confirm"),cancelButtonText:p.t("commons.button.cancel"),type:"info"}).then(async()=>{await X({key:t,value:d}).then(async()=>{await D(),m.value=!1,k(p.t("commons.msg.operationSuccess")),q.push({name:"login",params:{code:""}}),_.setLogStatus(!1)}).catch(()=>{m.value=!1})})},v=async(o,t,d)=>{if(!o||!await o.validateField(t.replace(t[0],t[0].toLowerCase()),I)||d==="")return;switch(m.value=!0,t){case"Language":p.locale.value=d,_.updateLanguage(d);break;case"Theme":_.setThemeConfig({...U.value,theme:d}),P();break;case"SessionTimeout":if(Number(d)<300){m.value=!1,Z(p.t("setting.sessionTimeoutError")),S();return}break;case"PanelName":_.setThemeConfig({...U.value,panelName:d}),document.title=d;break;case"MonitorStoreDays":case"ServerPort":d=d+"";break}let y={key:t,value:d+""};await X(y).then(async()=>{if(y.key==="UserName"){await D(),m.value=!1,k(p.t("commons.msg.operationSuccess")),q.push({name:"login",params:{code:""}}),_.setLogStatus(!1);return}y.key==="Language"&&location.reload(),m.value=!1,k(p.t("commons.msg.operationSuccess")),S()}).catch(()=>{m.value=!1})};function F(){$.value=V.value,T.value=!0,l.value=setInterval(()=>{$.value>0&&$.value<=V.value?$.value--:(T.value=!1,clearInterval(l.value),l.value=null)},1e3)}function I(o){if(o)return o.message}const L=async()=>{m.value=!0,await he().then(o=>{m.value=!1,s.localTime=o.data,F(),k(p.t("commons.msg.operationSuccess"))}).catch(()=>{m.value=!1})};return ge(()=>{S()}),(o,t)=>{const d=oe,u=le,y=ee,h=ae,ue=Y("Sunny"),G=be,O=ve,ie=Y("Moon"),j=_e,z=ye,de=se,me=ne;return x((B(),W("div",null,[e(Ve,{title:o.$t("setting.panel"),divider:!0},{main:a(()=>[e(C(te),{model:s,ref_key:"panelFormRef",ref:n,"label-position":"left","label-width":"160px"},{default:a(()=>[e(de,null,{default:a(()=>[e(d,{span:1},{default:a(()=>[Ue]),_:1}),e(d,{span:10},{default:a(()=>[e(h,{label:o.$t("setting.user"),rules:C(b).userName,prop:"userName"},{default:a(()=>[e(y,{clearable:"",modelValue:s.userName,"onUpdate:modelValue":t[1]||(t[1]=i=>s.userName=i)},{append:a(()=>[e(u,{style:{width:"85px"},onClick:t[0]||(t[0]=i=>c(n.value,"UserName",s.userName)),icon:"Collection"},{default:a(()=>[w(f(o.$t("commons.button.save")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","rules"]),e(h,{label:o.$t("setting.passwd"),rules:C(b).requiredInput,prop:"password"},{default:a(()=>[e(y,{type:"password",clearable:"",disabled:"",modelValue:s.password,"onUpdate:modelValue":t[2]||(t[2]=i=>s.password=i)},{append:a(()=>[e(u,{style:{width:"85px"},icon:"Setting",onClick:r},{default:a(()=>[w(f(o.$t("commons.button.set")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","rules"]),e(h,{label:o.$t("setting.theme"),rules:C(b).requiredSelect,prop:"theme"},{default:a(()=>[e(j,{onChange:t[3]||(t[3]=i=>v(n.value,"Theme",s.theme)),modelValue:s.theme,"onUpdate:modelValue":t[4]||(t[4]=i=>s.theme=i)},{default:a(()=>[e(O,{label:"light"},{default:a(()=>[e(G,null,{default:a(()=>[e(ue)]),_:1}),w(" "+f(o.$t("setting.light")),1)]),_:1}),e(O,{label:"dark"},{default:a(()=>[e(G,null,{default:a(()=>[e(ie)]),_:1}),w(" "+f(o.$t("setting.dark")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","rules"]),e(h,{label:o.$t("setting.title"),rules:C(b).requiredInput,prop:"panelName"},{default:a(()=>[e(y,{clearable:"",modelValue:s.panelName,"onUpdate:modelValue":t[6]||(t[6]=i=>s.panelName=i)},{append:a(()=>[e(u,{style:{width:"85px"},onClick:t[5]||(t[5]=i=>v(n.value,"PanelName",s.panelName)),icon:"Collection"},{default:a(()=>[w(f(o.$t("commons.button.save")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","rules"]),e(h,{label:o.$t("setting.language"),rules:C(b).requiredSelect,prop:"language"},{default:a(()=>[e(j,{style:{width:"100%"},onChange:t[7]||(t[7]=i=>v(n.value,"Language",s.language)),modelValue:s.language,"onUpdate:modelValue":t[8]||(t[8]=i=>s.language=i)},{default:a(()=>[e(z,{label:"zh"},{default:a(()=>[w("\u4E2D\u6587")]),_:1}),e(z,{label:"en"},{default:a(()=>[w("English")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","rules"]),e(h,{label:o.$t("setting.sessionTimeout"),rules:[C(b).integerNumber,C(Te)(300,864e3)],prop:"sessionTimeout"},{default:a(()=>[e(y,{modelValue:s.sessionTimeout,"onUpdate:modelValue":t[10]||(t[10]=i=>s.sessionTimeout=i),modelModifiers:{number:!0}},{append:a(()=>[e(u,{style:{width:"85px"},onClick:t[9]||(t[9]=i=>v(n.value,"SessionTimeout",s.sessionTimeout)),icon:"Collection"},{default:a(()=>[w(f(o.$t("commons.button.save")),1)]),_:1})]),_:1},8,["modelValue"]),N("div",null,[N("span",Ee,f(o.$t("setting.sessionTimeoutHelper",[s.sessionTimeout])),1)])]),_:1},8,["label","rules"]),e(h,{label:o.$t("setting.syncTime")},{default:a(()=>[e(y,{disabled:"",modelValue:s.localTime,"onUpdate:modelValue":t[11]||(t[11]=i=>s.localTime=i)},{append:a(()=>[x(e(u,{style:{width:"85px"},onClick:L,icon:"Refresh"},{default:a(()=>[w(f(o.$t("commons.button.sync")),1)]),_:1},512),[[J,!T.value]]),x(N("div",Ie,[N("span",null,f($.value)+" "+f(o.$t("setting.second")),1)],512),[[J,T.value]])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]),e(ke,{ref_key:"passwordRef",ref:E},null,512)])),[[me,m.value]])}}});export{oa as default};
