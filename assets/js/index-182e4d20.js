import{d as N,u as j,x as $,S as x,r as A,o as D,b as n,h as p,i as f,e as c,w as r,c as s,O as m,F as h,g as I,t as P,v as z,a1 as G,K as T,L as Z,ai as H,a2 as J,l as Q,m as W}from"./index-9eeac04e.js";/* empty css            */import"./form-item-d76e7d20.js";/* empty css             *//* empty css              *//* empty css            *//* empty css               *//* empty css               */import{g as X}from"./util-cbaccc93.js";import{f as Y}from"./app-b908b206.js";import{R as _}from"./form-rules-028b05ac.js";const ee={key:4},le={key:0},pe=N({__name:"index",props:{form:{type:Object,default:function(){return{}}},params:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}},propStart:{type:String,default:""}},emits:["update:form","update:rules"],setup(B,{emit:U}){const b=B,F=j(),t=$({});let v=$({});const K=x({get(){return b.params},set(){}}),O=x({get(){return b.propStart},set(){}}),S=A([]),y=()=>{U("update:form",t)},R=()=>{if(v=b.rules,K.value!=null&&K.value.formFields!=null)for(const e of K.value.formFields){const d=e;d.prop=O.value+e.envKey,d.disabled=e.disabled,S.value.push(d),e.random?t[e.envKey]=e.default+"_"+X(6):t[e.envKey]=e.default,e.required&&(e.type==="service"||e.type==="apps"?(v[e.envKey]=[_.requiredSelect],e.child&&(e.childProp=e.child.envKey,e.child.type==="service"&&(v[e.child.envKey]=[_.requiredSelect]))):v[e.envKey]=[_.requiredInput],e.rule&&e.rule!=""&&v[e.envKey].push(_[e.rule])),e.type==="apps"&&(g(e.child.envKey,e.default,e),e.child.services=[],t[e.child.envKey]=""),e.type==="service"&&(g(e.envKey,e.key,e),e.services=[],t[e.envKey]=""),U("update:rules",v),y()}},g=async(e,d,o)=>{o.services=[],await Y(d).then(u=>{o.services=u.data||[],t[e]="",u.data&&u.data.length>0&&(t[e]=u.data[0].value,o.params&&o.params.forEach(i=>{i.key===d&&(t[i.envKey]=i.value)}),V(t[e],o.services))})},V=(e,d)=>{d.forEach(o=>{o.value===e&&o.config&&Object.entries(o.config).forEach(([u,i])=>{t.hasOwnProperty(u)&&(t[u]=i)})}),y()},q=e=>z().locale.value=="zh"?e.labelZh:e.labelEn,E=e=>{F.push({name:"AppDetail",params:{appKey:e}})};return D(()=>{R()}),(e,d)=>{const o=G,u=T,i=Z,w=H,k=J,C=Q,L=W;return n(!0),p(h,null,f(S.value,(l,M)=>(n(),p("div",{key:M},[c(k,{label:q(l),prop:l.prop},{default:r(()=>[l.type=="text"?(n(),s(o,{key:0,modelValue:t[l.envKey],"onUpdate:modelValue":a=>t[l.envKey]=a,modelModifiers:{trim:!0},type:l.type,onChange:y,disabled:l.disabled},null,8,["modelValue","onUpdate:modelValue","type","disabled"])):m("",!0),l.type=="number"?(n(),s(o,{key:1,modelValue:t[l.envKey],"onUpdate:modelValue":a=>t[l.envKey]=a,modelModifiers:{number:!0},onBlur:a=>t[l.envKey]=Number(t[l.envKey]),maxlength:"15",onChange:y,disabled:l.disabled},null,8,["modelValue","onUpdate:modelValue","onBlur","disabled"])):m("",!0),l.type=="password"?(n(),s(o,{key:2,modelValue:t[l.envKey],"onUpdate:modelValue":a=>t[l.envKey]=a,modelModifiers:{trim:!0},type:l.type,"show-password":"",clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","type"])):m("",!0),l.type=="service"?(n(),s(i,{key:3,style:{width:"100%"},modelValue:t[l.envKey],"onUpdate:modelValue":a=>t[l.envKey]=a,onChange:a=>V(t[l.envKey],l.services)},{default:r(()=>[(n(!0),p(h,null,f(l.services,a=>(n(),s(u,{key:a.label,value:a.value,label:a.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):m("",!0),l.type==="service"&&l.services.length===0?(n(),p("span",ee,[c(w,{type:"primary",underline:!1,onClick:a=>E(l.key)},{default:r(()=>[I(P(e.$t("app.toInstall")),1)]),_:2},1032,["onClick"])])):m("",!0),l.type=="select"?(n(),s(i,{key:5,modelValue:t[l.envKey],"onUpdate:modelValue":a=>t[l.envKey]=a},{default:r(()=>[(n(!0),p(h,null,f(l.values,a=>(n(),s(u,{key:a.label,value:a.value,label:a.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):m("",!0),l.type=="apps"?(n(),s(L,{key:6,gutter:10},{default:r(()=>[c(C,{span:12},{default:r(()=>[c(k,{prop:l.prop},{default:r(()=>[c(i,{modelValue:t[l.envKey],"onUpdate:modelValue":a=>t[l.envKey]=a,onChange:a=>g(l.child.envKey,t[l.envKey],l),style:{width:"100%"}},{default:r(()=>[(n(!0),p(h,null,f(l.values,a=>(n(),s(u,{label:a.label,key:a.value,value:a.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["prop"])]),_:2},1024),c(C,{span:12},{default:r(()=>[c(k,{prop:l.childProp},{default:r(()=>[l.child.type=="service"?(n(),s(i,{key:0,modelValue:t[l.child.envKey],"onUpdate:modelValue":a=>t[l.child.envKey]=a,onChange:a=>V(t[l.child.envKey],l.services)},{default:r(()=>[(n(!0),p(h,null,f(l.services,a=>(n(),s(u,{key:a.label,value:a.value,label:a.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):m("",!0)]),_:2},1032,["prop"])]),_:2},1024),c(C,null,{default:r(()=>[l.child.type==="service"&&l.services.length===0?(n(),p("span",le,[c(w,{type:"primary",underline:!1,onClick:a=>E(t[l.envKey])},{default:r(()=>[I(P(e.$t("app.toInstall")),1)]),_:2},1032,["onClick"])])):m("",!0)]),_:2},1024)]),_:2},1024)):m("",!0)]),_:2},1032,["label","prop"])]))),128)}}});export{pe as _};
