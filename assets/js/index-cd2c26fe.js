import{d as x,r as c,x as J,b as N,c as F,w as a,e,f as i,g as V,t as n,Y as G,h as A,y as _,a3 as Y,O as K,$ as W,j as k,K as Se,L as Ne,a1 as oe,a2 as ee,l as ne,m as ae,A as le,af as ze,a5 as de,ag as ge,a4 as Me,ao as Re,au as Fe,u as aa,ah as Ie,M as la,N as ta,_ as sa,ac as oa,q as na,s as ia,F as ra,i as ua,ax as da,a as _a,U as pa,aK as ca,n as ma,aJ as _e,aq as fa,a0 as ba,C as va,ai as ha,ab as ya,a6 as He,ae as ga,V as za,X as ce}from"./index-9eeac04e.js";/* empty css                *//* empty css               *//* empty css                *//* empty css              *//* empty css             *//* empty css             *//* empty css             *//* empty css                     *//* empty css                 *//* empty css            *//* empty css            *//* empty css              *//* empty css               */import{_ as Le}from"./layout-content-27c09564.js";import{_ as wa}from"./index-8d9ad139.js";import{_ as we}from"./index-bb4c3e65.js";import"./form-item-d76e7d20.js";/* empty css               *//* empty css               */import{R as I,c as T}from"./form-rules-028b05ac.js";import{a as $a,d as ka,b as je,u as qe,c as Te,e as Va,f as Ae,g as Ca,h as qa,i as Be,j as Pa,s as Sa,k as Na}from"./database-a10f2df4.js";/* empty css             */import{_ as ue}from"./index-8a66c1e6.js";import{k as Ra,l as Ia,m as Ha,n as Ba}from"./app-b908b206.js";/* empty css               *//* empty css                          */import{_ as Da}from"./index-0f189ddb.js";/* empty css                    */import{c as De,f as Ua,b as Ma}from"./util-cbaccc93.js";import{j as Ee,o as Oe,T as Ke}from"./index-b02b032a.js";import{L as We}from"./files-d9eb6d1f.js";import{l as Pe}from"./setting-f1c3ee2a.js";import{_ as Fa}from"./index-38d41e83.js";import{a as La,_ as ja}from"./index-99d2e1aa.js";import"./index-5ffc91ba.js";import"./base64-e52cbffd.js";import"./container-186b6752.js";import"./no_app-68a0aee4.js";import"./index-167a1d38.js";import"./use-delete-data-8b6821a4.js";/* empty css                 */const Ta={class:"dialog-footer"},Aa=x({__name:"index",emits:["search"],setup(E,{expose:H,emit:u}){const h=c(),v=c(!1),t=J({name:"",mysqlName:"",format:"",username:"",password:"",permission:"",permissionIPs:"",description:""}),C=J({name:[I.requiredInput,I.dbName],username:[I.requiredInput,I.name],password:[I.requiredInput],permission:[I.requiredSelect],permissionIPs:[I.requiredInput]}),r=c(),l=b=>{t.name="",t.mysqlName=b.mysqlName,t.format="utf8mb4",t.username="",t.password="",t.permission="%",t.permissionIPs="",t.description="",v.value=!0},P=()=>{v.value=!1},S=async b=>{!b||b.validate(async d=>{!d||(t.permission==="ip"&&(t.permission=t.permissionIPs),h.value=!0,await $a(t).then(()=>{h.value=!1,W(k.global.t("commons.msg.operationSuccess")),u("search"),v.value=!1}).catch(()=>{h.value=!1}))})};return H({acceptParams:l}),(b,d)=>{const p=Se,z=Ne,o=oe,f=ee,q=ne,B=ae,D=le,w=ze,$=de;return N(),F(w,{modelValue:v.value,"onUpdate:modelValue":d[9]||(d[9]=y=>v.value=y),"destroy-on-close":!0,"close-on-click-modal":!1,size:"50%"},{header:a(()=>[e(we,{header:b.$t("database.create"),back:P},null,8,["header"])]),footer:a(()=>[i("span",Ta,[e(D,{disabled:h.value,onClick:d[7]||(d[7]=y=>v.value=!1)},{default:a(()=>[V(n(b.$t("commons.button.cancel")),1)]),_:1},8,["disabled"]),e(D,{disabled:h.value,type:"primary",onClick:d[8]||(d[8]=y=>S(r.value))},{default:a(()=>[V(n(b.$t("commons.button.confirm")),1)]),_:1},8,["disabled"])])]),default:a(()=>[G((N(),A("div",null,[e(_(Y),{ref_key:"formRef",ref:r,"label-position":"top",model:t,rules:C},{default:a(()=>[e(B,{type:"flex",justify:"center"},{default:a(()=>[e(q,{span:22},{default:a(()=>[e(f,{label:b.$t("commons.table.name"),prop:"name"},{default:a(()=>[e(o,{clearable:"",modelValue:t.name,"onUpdate:modelValue":d[1]||(d[1]=y=>t.name=y),modelModifiers:{trim:!0}},{append:a(()=>[e(z,{modelValue:t.format,"onUpdate:modelValue":d[0]||(d[0]=y=>t.format=y),style:{width:"120px"}},{default:a(()=>[e(p,{label:"utf8mb4",value:"utf8mb4"}),e(p,{label:"utf-8",value:"utf8"}),e(p,{label:"gbk",value:"gbk"}),e(p,{label:"big5",value:"big5"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(f,{label:b.$t("commons.login.username"),prop:"username"},{default:a(()=>[e(o,{clearable:"",modelValue:t.username,"onUpdate:modelValue":d[2]||(d[2]=y=>t.username=y),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),e(f,{label:b.$t("commons.login.password"),prop:"password"},{default:a(()=>[e(o,{type:"password",clearable:"","show-password":"",modelValue:t.password,"onUpdate:modelValue":d[3]||(d[3]=y=>t.password=y),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),e(f,{label:b.$t("database.permission"),prop:"permission"},{default:a(()=>[e(z,{modelValue:t.permission,"onUpdate:modelValue":d[4]||(d[4]=y=>t.permission=y)},{default:a(()=>[e(p,{value:"%",label:b.$t("database.permissionAll")},null,8,["label"]),e(p,{value:"ip",label:b.$t("database.permissionForIP")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t.permission==="ip"?(N(),F(f,{key:0,prop:"permissionIPs"},{default:a(()=>[e(o,{clearable:"",modelValue:t.permissionIPs,"onUpdate:modelValue":d[5]||(d[5]=y=>t.permissionIPs=y)},null,8,["modelValue"])]),_:1})):K("",!0),e(f,{label:b.$t("commons.table.description"),prop:"description"},{default:a(()=>[e(o,{type:"textarea",clearable:"",modelValue:t.description,"onUpdate:modelValue":d[6]||(d[6]=y=>t.description=y)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[$,h.value]])]),_:1},8,["modelValue"])}}}),Ea={class:"input-help"},Oa={class:"input-help"},Ka={style:{"font-size":"12px"}},Wa={style:{"font-size":"12px",color:"red","font-weight":"500"}},Ga={style:{"font-size":"12px"}},Qa={class:"dialog-footer"},Ja=x({__name:"index",emits:["search"],setup(E,{expose:H,emit:u}){let h=c({id:0,deleteBackup:!1,forceDelete:!1}),v=c(!1),t=c(!1),C=c(""),r=c("");const l=c(),P=async b=>{h.value={id:b.id,deleteBackup:!1,forceDelete:!1},r.value=b.name,C.value="",v.value=!0},S=async()=>{t.value=!0,ka(h.value).then(()=>{t.value=!1,u("search"),W(k.global.t("commons.msg.deleteSuccess")),v.value=!1}).catch(()=>{t.value=!1})};return H({acceptParams:P}),(b,d)=>{const p=Me,z=ee,o=oe,f=Y,q=le,B=Re,D=de;return N(),F(B,{modelValue:_(v),"onUpdate:modelValue":d[4]||(d[4]=w=>ge(v)?v.value=w:v=w),title:b.$t("commons.button.delete")+" - "+_(r),width:"30%","close-on-click-modal":!1},{footer:a(()=>[i("span",Qa,[e(q,{onClick:d[3]||(d[3]=w=>ge(v)?v.value=!1:v=!1),disabled:_(t)},{default:a(()=>[V(n(b.$t("commons.button.cancel")),1)]),_:1},8,["disabled"]),e(q,{type:"primary",onClick:S,disabled:_(C)!=_(r)||_(t)},{default:a(()=>[V(n(b.$t("commons.button.confirm")),1)]),_:1},8,["disabled"])])]),default:a(()=>[G((N(),F(f,{ref_key:"deleteForm",ref:l},{default:a(()=>[e(z,null,{default:a(()=>[e(p,{modelValue:_(h).forceDelete,"onUpdate:modelValue":d[0]||(d[0]=w=>_(h).forceDelete=w),label:b.$t("app.forceDelete")},null,8,["modelValue","label"]),i("span",Ea,n(b.$t("app.forceDeleteHelper")),1)]),_:1}),e(z,null,{default:a(()=>[e(p,{modelValue:_(h).deleteBackup,"onUpdate:modelValue":d[1]||(d[1]=w=>_(h).deleteBackup=w),label:b.$t("app.deleteBackup")},null,8,["modelValue","label"]),i("span",Oa,n(b.$t("app.deleteBackupHelper")),1)]),_:1}),e(z,null,{default:a(()=>[i("div",null,[i("span",Ka,n(b.$t("database.delete")),1),i("span",Wa,n(_(r)),1),i("span",Ga,n(b.$t("database.deleteHelper")),1)]),e(o,{modelValue:_(C),"onUpdate:modelValue":d[2]||(d[2]=w=>ge(C)?C.value=w:C=w),placeholder:_(r)},null,8,["modelValue","placeholder"])]),_:1})]),_:1})),[[D,_(t)]])]),_:1},8,["modelValue","title"])}}}),xa={key:0},Xa={key:1},Ya={class:"dialog-footer"},Za=x({__name:"index",emits:["search"],setup(E,{expose:H,emit:u}){const h=c(),v=c(!1),t=c(),C=c(),r=J({id:0,mysqlName:"",userName:"",password:"",operation:"",privilege:"",privilegeIPs:"",value:""}),l=c(),P=p=>{C.value=p.operation==="password"?k.global.t("database.changePassword"):k.global.t("database.permission"),r.id=p.id,r.mysqlName=p.mysqlName,r.userName=p.username,r.password=p.password,r.operation=p.operation,r.privilege=p.privilege,r.privilegeIPs=p.privilegeIPs,r.value=p.value,v.value=!0},S=()=>{v.value=!1},b=async p=>{!p||p.validate(async z=>{if(!z)return;let o={id:r.id,value:""};if(r.operation==="password"){const f=await je(r.id);if(f.data&&f.data.length>0){let q={header:k.global.t("database.changePassword"),operationInfo:k.global.t("database.changePasswordHelper"),submitInputInfo:k.global.t("database.restartNow")};l.value.acceptParams(q)}else o.value=r.password,h.value=!0,await qe(o).then(()=>{h.value=!1,u("search"),v.value=!1,W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{h.value=!1});return}r.privilege!=="ip"?o.value=r.privilege:o.value=r.privilegeIPs.replaceAll("/n",","),h.value=!0,await Te(o).then(()=>{h.value=!1,u("search"),v.value=!1,W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{h.value=!1})})},d=async()=>{let p={id:r.id,value:r.password};h.value=!0,await qe(p).then(()=>{h.value=!1,u("search"),v.value=!1,W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{h.value=!1})};return H({acceptParams:P}),(p,z)=>{const o=oe,f=ee,q=Se,B=Ne,D=ne,w=ae,$=le,y=ze,U=ue,O=de;return N(),A("div",null,[e(y,{modelValue:v.value,"onUpdate:modelValue":z[6]||(z[6]=g=>v.value=g),"destroy-on-close":!0,"close-on-click-modal":!1,width:"30%"},{header:a(()=>[e(we,{header:C.value,back:S},null,8,["header"])]),footer:a(()=>[i("span",Ya,[e($,{disabled:h.value,onClick:z[4]||(z[4]=g=>v.value=!1)},{default:a(()=>[V(n(p.$t("commons.button.cancel")),1)]),_:1},8,["disabled"]),e($,{disabled:h.value,type:"primary",onClick:z[5]||(z[5]=g=>b(t.value))},{default:a(()=>[V(n(p.$t("commons.button.confirm")),1)]),_:1},8,["disabled"])])]),default:a(()=>[e(_(Y),null,{default:a(()=>[G((N(),F(_(Y),{ref_key:"changeFormRef",ref:t,model:r,"label-position":"top"},{default:a(()=>[e(w,{type:"flex",justify:"center"},{default:a(()=>[e(D,{span:22},{default:a(()=>[r.operation==="password"?(N(),A("div",xa,[e(f,{label:p.$t("commons.login.username"),prop:"userName"},{default:a(()=>[e(o,{disabled:"",modelValue:r.userName,"onUpdate:modelValue":z[0]||(z[0]=g=>r.userName=g)},null,8,["modelValue"])]),_:1},8,["label"]),e(f,{label:p.$t("commons.login.password"),prop:"password",rules:_(I).requiredInput},{default:a(()=>[e(o,{type:"password",clearable:"","show-password":"",modelValue:r.password,"onUpdate:modelValue":z[1]||(z[1]=g=>r.password=g)},null,8,["modelValue"])]),_:1},8,["label","rules"])])):K("",!0),r.operation==="privilege"?(N(),A("div",Xa,[e(f,{label:p.$t("database.permission"),prop:"privilege"},{default:a(()=>[e(B,{style:{width:"100%"},modelValue:r.privilege,"onUpdate:modelValue":z[2]||(z[2]=g=>r.privilege=g)},{default:a(()=>[e(q,{value:"%",label:p.$t("database.permissionAll")},null,8,["label"]),e(q,{value:"ip",label:p.$t("database.permissionForIP")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),r.privilege==="ip"?(N(),F(f,{key:0,prop:"privilegeIPs",rules:_(I).requiredInput},{default:a(()=>[e(o,{placeholder:p.$t("database.remoteHelper"),clearable:"",autosize:{minRows:2,maxRows:5},type:"textarea",modelValue:r.privilegeIPs,"onUpdate:modelValue":z[3]||(z[3]=g=>r.privilegeIPs=g)},null,8,["placeholder","modelValue"])]),_:1},8,["rules"])):K("",!0)])):K("",!0)]),_:1})]),_:1})]),_:1},8,["model"])),[[O,h.value]])]),_:1})]),_:1},8,["modelValue"]),e(U,{ref_key:"confirmDialogRef",ref:l,onConfirm:d},null,512)])}}}),el={class:"dialog-footer"},al=x({__name:"index",setup(E,{expose:H}){const u=c(!1),h=c(!1),v=J({password:""}),t=c(),C=c(),r=()=>{v.password="",P(),h.value=!0},l=()=>{h.value=!1},P=async()=>{const d=await Ra("mysql");v.password=d.data},S=async()=>{let d={id:0,value:v.password};u.value=!0,await qe(d).then(()=>{u.value=!1,W(k.global.t("commons.msg.operationSuccess")),h.value=!1}).catch(()=>{u.value=!1})},b=async d=>{!d||d.validate(async p=>{if(!p)return;let z={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};t.value.acceptParams(z)})};return H({acceptParams:r}),(d,p)=>{const z=oe,o=ee,f=ne,q=ae,B=le,D=ze,w=de;return N(),F(D,{modelValue:h.value,"onUpdate:modelValue":p[3]||(p[3]=$=>h.value=$),"destroy-on-close":!0,"close-on-click-modal":!1,size:"30%"},{header:a(()=>[e(we,{header:d.$t("database.rootPassword"),back:l},null,8,["header"])]),footer:a(()=>[i("span",el,[e(B,{disabled:u.value,onClick:p[1]||(p[1]=$=>h.value=!1)},{default:a(()=>[V(n(d.$t("commons.button.cancel")),1)]),_:1},8,["disabled"]),e(B,{disabled:u.value,type:"primary",onClick:p[2]||(p[2]=$=>b(C.value))},{default:a(()=>[V(n(d.$t("commons.button.confirm")),1)]),_:1},8,["disabled"])])]),default:a(()=>[G((N(),F(_(Y),{ref_key:"formRef",ref:C,model:v,"label-position":"top"},{default:a(()=>[e(q,{type:"flex",justify:"center"},{default:a(()=>[e(f,{span:22},{default:a(()=>[e(o,{label:d.$t("database.rootPassword"),rules:_(I).requiredInput,prop:"password"},{default:a(()=>[e(z,{type:"password","show-password":"",clearable:"",modelValue:v.password,"onUpdate:modelValue":p[0]||(p[0]=$=>v.password=$)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})]),_:1})]),_:1},8,["model"])),[[w,u.value]]),e(ue,{ref_key:"confirmDialogRef",ref:t,onConfirm:S},null,512)]),_:1},8,["modelValue"])}}}),ll={class:"input-help"},tl={class:"dialog-footer"},sl=x({__name:"index",setup(E,{expose:H}){const u=c(!1),h=c(!1),v=J({privilege:!1}),t=c(),C=c(),r=b=>{v.privilege=b.privilege,h.value=!0},l=()=>{h.value=!1},P=async()=>{let b={id:0,value:v.privilege?"%":"localhost"};u.value=!0,await Te(b).then(()=>{u.value=!1,W(k.global.t("commons.msg.operationSuccess")),h.value=!1}).catch(()=>{u.value=!1})},S=async b=>{!b||b.validate(async d=>{if(!d)return;let p={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};t.value.acceptParams(p)})};return H({acceptParams:r}),(b,d)=>{const p=Fe,z=ee,o=ne,f=ae,q=le,B=ze,D=de;return N(),F(B,{modelValue:h.value,"onUpdate:modelValue":d[3]||(d[3]=w=>h.value=w),"destroy-on-close":!0,"close-on-click-modal":!1,size:"40%"},{header:a(()=>[e(we,{header:b.$t("database.remoteAccess"),back:l},null,8,["header"])]),footer:a(()=>[i("span",tl,[e(q,{onClick:d[1]||(d[1]=w=>h.value=!1)},{default:a(()=>[V(n(b.$t("commons.button.cancel")),1)]),_:1}),e(q,{type:"primary",onClick:d[2]||(d[2]=w=>S(C.value))},{default:a(()=>[V(n(b.$t("commons.button.confirm")),1)]),_:1})])]),default:a(()=>[G((N(),F(_(Y),{ref_key:"formRef",ref:C,model:v,"label-position":"top"},{default:a(()=>[e(f,{type:"flex",justify:"center"},{default:a(()=>[e(o,{span:22},{default:a(()=>[e(z,{label:b.$t("database.remoteAccess"),rules:_(I).requiredInput,prop:"privilege"},{default:a(()=>[e(p,{modelValue:v.privilege,"onUpdate:modelValue":d[0]||(d[0]=w=>v.privilege=w)},null,8,["modelValue"]),i("span",ll,n(b.$t("database.remoteConnHelper")),1)]),_:1},8,["label","rules"])]),_:1})]),_:1})]),_:1},8,["model"])),[[D,u.value]]),e(ue,{ref_key:"confirmDialogRef",ref:t,onConfirm:P},null,512)]),_:1},8,["modelValue"])}}}),ol=i("br",null,null,-1),nl=x({__name:"index",setup(E,{expose:H}){const u=aa(),h=c();let v=c(!1);const t=r=>{h.value=r.items,v.value=!0},C=()=>{u.push({name:"App"})};return H({acceptParams:t}),(r,l)=>{const P=Ie,S=la,b=ta,d=ne,p=ae,z=Re;return N(),F(z,{modelValue:_(v),"onUpdate:modelValue":l[1]||(l[1]=o=>ge(v)?v.value=o:v=o),title:r.$t("app.checkTitle"),width:"50%","close-on-click-modal":!1,"destroy-on-close":!0},{default:a(()=>[e(p,null,{default:a(()=>[e(P,{type:"warning",description:r.$t("app.deleteHelper",[r.$t("app.database")]),center:"","show-icon":"",closable:!1},null,8,["description"]),e(d,{span:12,offset:6},{default:a(()=>[ol,e(b,{border:"",column:1},{default:a(()=>[e(S,null,{label:a(()=>[i("a",{href:"javascript:void(0);",onClick:l[0]||(l[0]=o=>C())},n(r.$t("app.app")),1)]),default:a(()=>[V(" "+n(h.value.join(",")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])}}});const Ge=E=>(na("data-v-58c584f4"),E=E(),ia(),E),il={class:"title"},rl={class:"status-label"},ul={class:"status-count"},dl={class:"status-label"},_l={class:"status-count"},pl={class:"status-label"},cl={class:"status-count"},ml={class:"status-label"},fl={class:"status-count"},bl={class:"status-label"},vl={class:"status-count"},hl={class:"status-label"},yl={class:"status-count"},gl=Ge(()=>i("span",{class:"status-label"},"File",-1)),zl={class:"status-count"},wl=Ge(()=>i("span",{class:"status-label"},"Position",-1)),$l={class:"status-count"},kl={class:"title"},Vl={class:"status-label"},Cl={class:"status-count"},ql={class:"input-help"},Pl={class:"status-label"},Sl={class:"status-count"},Nl={class:"input-help"},Rl={class:"status-label"},Il={class:"status-count"},Hl={class:"input-help"},Bl={class:"status-label"},Dl={class:"status-count"},Ul={class:"input-help"},Ml={class:"status-label"},Fl={class:"status-count"},Ll={class:"input-help"},jl={class:"status-label"},Tl={class:"status-count"},Al={class:"input-help"},El={class:"status-label"},Ol={class:"status-count"},Kl={class:"input-help"},Wl={class:"status-label"},Gl={class:"status-count"},Ql={class:"input-help"},Jl={class:"status-label"},xl={class:"status-count"},Xl={class:"input-help"},Yl={class:"status-label"},Zl={class:"status-count"},et={class:"input-help"},at={class:"status-label"},lt={class:"status-count"},tt={class:"input-help"},st=x({__name:"index",setup(E,{expose:H}){let u=J({run:0,connections:0,bytesSent:"",bytesReceived:"",queryPerSecond:"",txPerSecond:"",file:"",position:0,connInfo:"",threadCacheHit:"",indexHit:"",innodbIndexHit:"",cacheHit:"",tmpTableToDB:"",openTables:0,selectFullJoin:0,selectRangeCheck:0,sortMergePasses:0,tableLocksWaited:0});const h=()=>{v()},v=async()=>{const t=await Va();let C=t.data.Questions/t.data.Uptime,r=(t.data.Com_commit+t.data.Com_rollback)/t.data.Uptime,l=(1-t.data.Threads_created/t.data.Connections)*100,P=t.data.Qcache_hits/(t.data.Qcache_hits+t.data.Qcache_inserts)*100,S=(1-t.data.Key_reads/t.data.Key_read_requests)*100,b=(1-t.data.Innodb_buffer_pool_reads/t.data.Innodb_buffer_pool_read_requests)*100,d=t.data.Created_tmp_disk_tables/t.data.Created_tmp_tables*100;u.run=t.data.Run,u.connections=t.data.Connections,u.bytesSent=t.data.Bytes_sent?De(t.data.Bytes_sent):"0",u.bytesReceived=t.data.Bytes_received?De(t.data.Bytes_received):"0",u.queryPerSecond=isNaN(C)||C===0?"0":C.toFixed(2),u.txPerSecond=isNaN(r)||r===0?"0":r.toFixed(2),u.file=t.data.File,u.position=t.data.Position,u.connInfo=t.data.Threads_running+"/"+t.data.Max_used_connections,u.threadCacheHit=isNaN(l)||l===0?"0":l.toFixed(2)+"%",u.indexHit=isNaN(S)||S===0?"0":S.toFixed(2)+"%",u.innodbIndexHit=isNaN(b)||b===0?"0":b.toFixed(2)+"%",u.cacheHit=isNaN(P)||P===0?"OFF":P.toFixed(2)+"%",u.tmpTableToDB=isNaN(d)||d===0?"0":d.toFixed(2)+"%",u.openTables=t.data.Open_tables,u.selectFullJoin=t.data.Select_full_join,u.selectRangeCheck=t.data.Select_range_check,u.sortMergePasses=t.data.Sort_merge_passes,u.tableLocksWaited=t.data.Table_locks_waited};return H({acceptParams:h}),(t,C)=>{const r=oa,l=ee,P=ae,S=Y;return N(),A("div",null,[e(S,{"label-position":"top"},{default:a(()=>[i("span",il,n(t.$t("database.baseParam")),1),e(r,{class:"devider"}),e(P,{type:"flex",style:{"margin-left":"50px"},justify:"center"},{default:a(()=>[e(l,{style:{width:"25%"}},{label:a(()=>[i("span",rl,n(t.$t("database.runTime")),1)]),default:a(()=>[i("span",ul,n(_(u).run),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",dl,n(t.$t("database.connections")),1)]),default:a(()=>[i("span",_l,n(_(u).connections),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",pl,n(t.$t("database.bytesSent")),1)]),default:a(()=>[i("span",cl,n(_(u).bytesSent),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",ml,n(t.$t("database.bytesReceived")),1)]),default:a(()=>[i("span",fl,n(_(u).bytesReceived),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",bl,n(t.$t("database.queryPerSecond")),1)]),default:a(()=>[i("span",vl,n(_(u).queryPerSecond),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",hl,n(t.$t("database.txPerSecond")),1)]),default:a(()=>[i("span",yl,n(_(u).txPerSecond),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[gl]),default:a(()=>[i("span",zl,n(_(u).file),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[wl]),default:a(()=>[i("span",$l,n(_(u).position),1)]),_:1})]),_:1}),i("span",kl,n(t.$t("database.performanceParam")),1),e(r,{class:"devider"}),e(P,{type:"flex",style:{"margin-left":"50px"},justify:"center"},{default:a(()=>[e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Vl,n(t.$t("database.queryPerSecond")),1)]),default:a(()=>[i("span",Cl,n(_(u).queryPerSecond),1),i("span",ql,n(t.$t("database.connInfoHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Pl,n(t.$t("database.threadCacheHit")),1)]),default:a(()=>[i("span",Sl,n(_(u).threadCacheHit),1),i("span",Nl,n(t.$t("database.threadCacheHitHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Rl,n(t.$t("database.indexHit")),1)]),default:a(()=>[i("span",Il,n(_(u).indexHit),1),i("span",Hl,n(t.$t("database.indexHitHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Bl,n(t.$t("database.innodbIndexHit")),1)]),default:a(()=>[i("span",Dl,n(_(u).innodbIndexHit),1),i("span",Ul,n(t.$t("database.innodbIndexHitHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Ml,n(t.$t("database.cacheHit")),1)]),default:a(()=>[i("span",Fl,n(_(u).cacheHit),1),i("span",Ll,n(t.$t("database.cacheHitHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",jl,n(t.$t("database.tmpTableToDB")),1)]),default:a(()=>[i("span",Tl,n(_(u).tmpTableToDB),1),i("span",Al,n(t.$t("database.tmpTableToDBHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",El,n(t.$t("database.openTables")),1)]),default:a(()=>[i("span",Ol,n(_(u).openTables),1),i("span",Kl,n(t.$t("database.openTablesHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Wl,n(t.$t("database.selectFullJoin")),1)]),default:a(()=>[i("span",Gl,n(_(u).selectFullJoin),1),i("span",Ql,n(t.$t("database.selectFullJoinHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Jl,n(t.$t("database.selectRangeCheck")),1)]),default:a(()=>[i("span",xl,n(_(u).selectRangeCheck),1),i("span",Xl,n(t.$t("database.selectRangeCheckHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",Yl,n(t.$t("database.sortMergePasses")),1)]),default:a(()=>[i("span",Zl,n(_(u).sortMergePasses),1),i("span",et,n(t.$t("database.sortMergePassesHelper")),1)]),_:1}),e(l,{style:{width:"25%"}},{label:a(()=>[i("span",at,n(t.$t("database.tableLocksWaited")),1)]),default:a(()=>[i("span",lt,n(_(u).tableLocksWaited),1),i("span",tt,n(t.$t("database.tableLocksWaitedHelper")),1)]),_:1}),e(l,{style:{width:"25%"}})]),_:1})]),_:1})])}}});var ot=sa(st,[["__scopeId","data-v-58c584f4"]]);const Ue=[{id:1,title:"1-2GB",data:{version:"",key_buffer_size:128,query_cache_size:64,tmp_table_size:64,innodb_buffer_pool_size:256,sort_buffer_size:768,read_buffer_size:768,read_rnd_buffer_size:512,join_buffer_size:1024,thread_stack:256,binlog_cache_size:64,thread_cache_size:64,table_open_cache:128,max_connections:100}},{id:2,title:"2-4GB",data:{version:"",key_buffer_size:256,query_cache_size:128,tmp_table_size:384,innodb_buffer_pool_size:384,sort_buffer_size:768,read_buffer_size:768,read_rnd_buffer_size:512,join_buffer_size:2048,thread_stack:256,binlog_cache_size:64,thread_cache_size:96,table_open_cache:192,max_connections:200}},{id:3,title:"4-8GB",data:{version:"",key_buffer_size:384,query_cache_size:192,tmp_table_size:512,innodb_buffer_pool_size:512,sort_buffer_size:1024,read_buffer_size:1024,read_rnd_buffer_size:768,join_buffer_size:2048,thread_stack:256,binlog_cache_size:128,thread_cache_size:128,table_open_cache:384,max_connections:300}},{id:4,title:"8-16GB",data:{version:"",key_buffer_size:512,query_cache_size:256,tmp_table_size:1024,innodb_buffer_pool_size:1024,sort_buffer_size:2048,read_buffer_size:2048,read_rnd_buffer_size:1024,join_buffer_size:4096,thread_stack:384,binlog_cache_size:192,thread_cache_size:192,table_open_cache:1024,max_connections:400}},{id:5,title:"16-32GB",data:{version:"",key_buffer_size:1024,query_cache_size:384,tmp_table_size:2048,innodb_buffer_pool_size:4096,innodb_log_buffer_size:32,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:2048,join_buffer_size:8192,thread_stack:512,binlog_cache_size:256,thread_cache_size:256,table_open_cache:2048,max_connections:500}}],nt=i("br",null,null,-1),it=i("br",null,null,-1),rt={class:"input-help"},ut={class:"input-help"},dt={class:"input-help"},_t={class:"input-help"},pt={class:"input-help"},ct={class:"input-help"},mt={class:"input-help"},ft=i("br",null,null,-1),bt={class:"input-help"},vt={class:"input-help"},ht={class:"input-help"},yt={class:"input-help"},gt={class:"input-help"},zt={class:"input-help"},wt={class:"input-help"},$t=x({__name:"index",emits:["loading"],setup(E,{expose:H,emit:u}){const h=c(),v=c(),t=c(),C=c(),r=c();let l=J({mysqlName:"",key_buffer_size:0,query_cache_size:0,tmp_table_size:0,innodb_buffer_pool_size:0,innodb_log_buffer_size:0,sort_buffer_size:0,read_buffer_size:0,read_rnd_buffer_size:0,join_buffer_size:0,thread_stack:0,binlog_cache_size:0,thread_cache_size:0,table_open_cache:0,max_connections:0,slow_query_log:"",long_query_time:0});const P=J({key_buffer_size:[I.number,T(1,102400)],query_cache_size:[I.number,T(0,102400)],tmp_table_size:[I.number,T(1,102400)],innodb_buffer_pool_size:[I.number,T(1,102400)],innodb_log_buffer_size:[I.number,T(1,102400)],sort_buffer_size:[I.number,T(1,102400)],read_buffer_size:[I.number,T(1,102400)],read_rnd_buffer_size:[I.number,T(1,102400)],join_buffer_size:[I.number,T(1,102400)],thread_stack:[I.number,T(1,102400)],binlog_cache_size:[I.number,T(1,102400)],thread_cache_size:[I.number,T(1,1e4)],table_open_cache:[I.number,T(1,1e4)],max_connections:[I.number,T(1,1e4)],slow_query_log:[I.requiredSelect],long_query_time:[I.number,T(1,102400)]}),S=c(),b=o=>{S.value=o.mysqlName,t.value=o.mysqlVersion,l.key_buffer_size=Number(o.variables.key_buffer_size)/1024/1024,l.query_cache_size=Number(o.variables.query_cache_size)/1024/1024,l.tmp_table_size=Number(o.variables.tmp_table_size)/1024/1024,l.innodb_buffer_pool_size=Number(o.variables.innodb_buffer_pool_size)/1024/1024,l.innodb_log_buffer_size=Number(o.variables.innodb_log_buffer_size)/1024/1024,l.sort_buffer_size=Number(o.variables.sort_buffer_size)/1024,l.read_buffer_size=Number(o.variables.read_buffer_size)/1024,l.read_rnd_buffer_size=Number(o.variables.read_rnd_buffer_size)/1024,l.join_buffer_size=Number(o.variables.join_buffer_size)/1024,l.thread_stack=Number(o.variables.thread_stack)/1024,l.binlog_cache_size=Number(o.variables.binlog_cache_size)/1024,l.thread_cache_size=Number(o.variables.thread_cache_size),l.table_open_cache=Number(o.variables.table_open_cache),l.max_connections=Number(o.variables.max_connections),r.value={...l}},d=async()=>{for(const o of Ue)if(o.id===h.value){l.key_buffer_size=o.data.key_buffer_size,l.query_cache_size=o.data.query_cache_size,l.tmp_table_size=o.data.tmp_table_size,l.innodb_buffer_pool_size=o.data.innodb_buffer_pool_size,l.sort_buffer_size=o.data.sort_buffer_size,l.read_buffer_size=o.data.read_buffer_size,l.read_rnd_buffer_size=o.data.read_rnd_buffer_size,l.join_buffer_size=o.data.join_buffer_size,l.thread_stack=o.data.thread_stack,l.binlog_cache_size=o.data.binlog_cache_size,l.thread_cache_size=o.data.thread_cache_size,l.table_open_cache=o.data.table_open_cache,l.max_connections=o.data.max_connections;break}},p=async o=>{!o||o.validate(async f=>{if(!f)return;let q={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};v.value.acceptParams(q)})},z=async()=>{var f,q,B,D,w,$,y,U,O,g,X,te,L,j;let o=[];((f=r.value)==null?void 0:f.key_buffer_size)!==l.key_buffer_size&&o.push({param:"key_buffer_size",value:l.key_buffer_size*1024*1024}),((q=r.value)==null?void 0:q.query_cache_size)!==l.query_cache_size&&o.push({param:"query_cache_size",value:l.query_cache_size*1024*1024}),((B=r.value)==null?void 0:B.tmp_table_size)!==l.tmp_table_size&&o.push({param:"tmp_table_size",value:l.tmp_table_size*1024*1024}),((D=r.value)==null?void 0:D.innodb_buffer_pool_size)!==l.innodb_buffer_pool_size&&o.push({param:"innodb_buffer_pool_size",value:l.innodb_buffer_pool_size*1024*1024}),((w=r.value)==null?void 0:w.innodb_log_buffer_size)!==l.innodb_log_buffer_size&&o.push({param:"innodb_log_buffer_size",value:l.innodb_log_buffer_size*1024*1024}),(($=r.value)==null?void 0:$.sort_buffer_size)!==l.sort_buffer_size&&o.push({param:"sort_buffer_size",value:l.sort_buffer_size*1024}),((y=r.value)==null?void 0:y.read_buffer_size)!==l.read_buffer_size&&o.push({param:"read_buffer_size",value:l.read_buffer_size*1024}),((U=r.value)==null?void 0:U.read_rnd_buffer_size)!==l.read_rnd_buffer_size&&o.push({param:"read_rnd_buffer_size",value:l.read_rnd_buffer_size*1024}),((O=r.value)==null?void 0:O.join_buffer_size)!==l.join_buffer_size&&o.push({param:"join_buffer_size",value:l.join_buffer_size*1024}),((g=r.value)==null?void 0:g.thread_stack)!==l.thread_stack&&o.push({param:"thread_stack",value:l.thread_stack*1024}),((X=r.value)==null?void 0:X.binlog_cache_size)!==l.binlog_cache_size&&o.push({param:"binlog_cache_size",value:l.binlog_cache_size*1024}),((te=r.value)==null?void 0:te.thread_cache_size)!==l.thread_cache_size&&o.push({param:"thread_cache_size",value:l.thread_cache_size}),((L=r.value)==null?void 0:L.table_open_cache)!==l.table_open_cache&&o.push({param:"table_open_cache",value:l.table_open_cache}),((j=r.value)==null?void 0:j.max_connections)!==l.max_connections&&o.push({param:"max_connections",value:l.max_connections}),u("loading",!0),await Ae(o).then(()=>{u("loading",!1),W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{u("loading",!1)})};return H({acceptParams:b}),(o,f)=>{const q=ne,B=Se,D=Ne,w=ee,$=ae,y=oe,U=le,O=Y;return N(),A("div",null,[e(O,{model:_(l),rules:P,ref_key:"variableFormRef",ref:C,"label-position":"top"},{default:a(()=>[e($,null,{default:a(()=>[e(q,{span:1},{default:a(()=>[nt]),_:1}),e(q,{span:9},{default:a(()=>[e(w,{label:o.$t("database.optimizationScheme")},{default:a(()=>[e(D,{onChange:d,clearable:"",modelValue:h.value,"onUpdate:modelValue":f[0]||(f[0]=g=>h.value=g)},{default:a(()=>[(N(!0),A(ra,null,ua(_(Ue),g=>(N(),F(B,{key:g.id,label:g.title,value:g.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e($,null,{default:a(()=>[e(q,{span:1},{default:a(()=>[it]),_:1}),e(q,{span:9},{default:a(()=>[e(w,{label:"key_buffer_size",prop:"key_buffer_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).key_buffer_size,"onUpdate:modelValue":f[1]||(f[1]=g=>_(l).key_buffer_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("MB")]),_:1},8,["modelValue"]),i("span",rt,n(o.$t("database.keyBufferSizeHelper")),1)]),_:1}),e(w,{label:"join_buffer_size",prop:"join_buffer_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).join_buffer_size,"onUpdate:modelValue":f[2]||(f[2]=g=>_(l).join_buffer_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("KB")]),_:1},8,["modelValue"]),i("span",ut,n(o.$t("database.joinBufferSizeHelper")),1)]),_:1}),e(w,{label:"tmp_table_size",prop:"tmp_table_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).tmp_table_size,"onUpdate:modelValue":f[3]||(f[3]=g=>_(l).tmp_table_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("MB")]),_:1},8,["modelValue"]),i("span",dt,n(o.$t("database.tmpTableSizeHelper")),1)]),_:1}),e(w,{label:"innodb_buffer_pool_size",prop:"innodb_buffer_pool_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).innodb_buffer_pool_size,"onUpdate:modelValue":f[4]||(f[4]=g=>_(l).innodb_buffer_pool_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("MB")]),_:1},8,["modelValue"]),i("span",_t,n(o.$t("database.innodbBufferPoolSizeHelper")),1)]),_:1}),e(w,{label:"innodb_log_buffer_size",prop:"innodb_log_buffer_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).innodb_log_buffer_size,"onUpdate:modelValue":f[5]||(f[5]=g=>_(l).innodb_log_buffer_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("MB")]),_:1},8,["modelValue"]),i("span",pt,n(o.$t("database.innodbLogBufferSizeHelper")),1)]),_:1}),e(w,{label:"sort_buffer_size",prop:"sort_buffer_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).sort_buffer_size,"onUpdate:modelValue":f[6]||(f[6]=g=>_(l).sort_buffer_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("KB")]),_:1},8,["modelValue"]),i("span",ct,n(o.$t("database.sortBufferSizeHelper")),1)]),_:1}),e(w,{label:"read_buffer_size",prop:"read_buffer_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).read_buffer_size,"onUpdate:modelValue":f[7]||(f[7]=g=>_(l).read_buffer_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("KB")]),_:1},8,["modelValue"]),i("span",mt,n(o.$t("database.readBufferSizeHelper")),1)]),_:1}),e(w,null,{default:a(()=>[e(U,{onClick:f[8]||(f[8]=g=>p(C.value)),type:"primary"},{default:a(()=>[V(n(o.$t("commons.button.save")),1)]),_:1})]),_:1})]),_:1}),e(q,{span:2},{default:a(()=>[ft]),_:1}),e(q,{span:9},{default:a(()=>[e(w,{label:"read_rnd_buffer_size",prop:"read_rnd_buffer_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).read_rnd_buffer_size,"onUpdate:modelValue":f[9]||(f[9]=g=>_(l).read_rnd_buffer_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("KB")]),_:1},8,["modelValue"]),i("span",bt,n(o.$t("database.readRndBufferSizeHelper")),1)]),_:1}),t.value==="5.7.39"?(N(),F(w,{key:0,label:"query_cache_size",prop:"query_cache_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).query_cache_size,"onUpdate:modelValue":f[10]||(f[10]=g=>_(l).query_cache_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("MB")]),_:1},8,["modelValue"]),i("span",vt,n(o.$t("database.queryCacheSizeHelper")),1)]),_:1})):K("",!0),e(w,{label:"thread_stack",prop:"thread_stack"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).thread_stack,"onUpdate:modelValue":f[11]||(f[11]=g=>_(l).thread_stack=g),modelModifiers:{number:!0}},{append:a(()=>[V("KB")]),_:1},8,["modelValue"]),i("span",ht,n(o.$t("database.threadStackelper")),1)]),_:1}),e(w,{label:"binlog_cache_size",prop:"binlog_cache_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).binlog_cache_size,"onUpdate:modelValue":f[12]||(f[12]=g=>_(l).binlog_cache_size=g),modelModifiers:{number:!0}},{append:a(()=>[V("KB")]),_:1},8,["modelValue"]),i("span",yt,n(o.$t("database.binlogCacheSizeHelper")),1)]),_:1}),e(w,{label:"thread_cache_size",prop:"thread_cache_size"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).thread_cache_size,"onUpdate:modelValue":f[13]||(f[13]=g=>_(l).thread_cache_size=g),modelModifiers:{number:!0}},null,8,["modelValue"]),i("span",gt,n(o.$t("database.threadCacheSizeHelper")),1)]),_:1}),e(w,{label:"table_open_cache",prop:"table_open_cache"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).table_open_cache,"onUpdate:modelValue":f[14]||(f[14]=g=>_(l).table_open_cache=g),modelModifiers:{number:!0}},null,8,["modelValue"]),i("span",zt,n(o.$t("database.tableOpenCacheHelper")),1)]),_:1}),e(w,{label:"max_connections",prop:"max_connections"},{default:a(()=>[e(y,{clearable:"",modelValue:_(l).max_connections,"onUpdate:modelValue":f[15]||(f[15]=g=>_(l).max_connections=g),modelModifiers:{number:!0}},null,8,["modelValue"]),i("span",wt,n(o.$t("database.maxConnectionsHelper")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),e(ue,{ref_key:"confirmDialogRef",ref:v,onConfirm:z},null,512)])}}}),kt={style:{float:"left"}},Vt={style:{float:"left","margin-left":"20px"}},Ct=i("br",null,null,-1),qt=x({__name:"index",emits:["loading"],setup(E,{expose:H,emit:u}){const h=[Ee(),Oe],v=c(),t=da(),C=$=>{t.value=$.view},r=c(),l=c(),P=c(),S=c();let b=null;const d=c(),p=J({slow_query_log:"OFF",long_query_time:10}),z=async $=>{if(d.value=$.mysqlName,p.slow_query_log=$.variables.slow_query_log,p.long_query_time=Number($.variables.long_query_time),p.slow_query_log==="ON"){l.value=!0,r.value=!0;let U=`${(await Pe()).data}/apps/mysql/${d.value}/data/1Panel-slow.log`;w(U),b=setInterval(()=>{p.slow_query_log==="ON"&&S.value&&w(U)},1e3*5)}},o=async()=>{if(p.slow_query_log==="ON"){r.value=!0;return}let $={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};P.value.acceptParams($)},f=()=>{if(!(p.long_query_time>0&&p.long_query_time<=600)){pa(k.global.t("database.thresholdRangeHelper"));return}let $={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};P.value.acceptParams($)},q=async()=>{p.slow_query_log=l.value?"ON":"OFF",r.value=l.value},B=async()=>{let $=[];$.push({param:"slow_query_log",value:p.slow_query_log}),p.slow_query_log==="ON"&&($.push({param:"long_query_time",value:p.long_query_time+""}),$.push({param:"slow_query_log_file",value:"/var/lib/mysql/1Panel-slow.log"})),u("loading",!0),await Ae($).then(()=>{u("loading",!1),l.value=p.slow_query_log==="ON",r.value=p.slow_query_log==="ON",W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{u("loading",!1)})},D=async()=>{if(!v.value){ca(k.global.t("database.noData"));return}const $=window.URL.createObjectURL(new Blob([v.value])),y=document.createElement("a");y.style.display="none",y.href=$,y.download=d.value+"-slowlogs-"+Ua(new Date)+".log";const U=new MouseEvent("click");y.dispatchEvent(U)},w=async $=>{const y=await We({path:$});v.value=y.data||"",ma(()=>{const U=t.value.state;t.value.dispatch({selection:{anchor:U.doc.length,head:U.doc.length},scrollIntoView:!0})})};return _a(()=>{clearInterval(Number(b)),b=null}),H({acceptParams:z}),($,y)=>{const U=Fe,O=ee,g=oe,X=le,te=Me,L=Y;return N(),A("div",null,[e(L,{"label-position":"left","label-width":"80px"},{default:a(()=>[e(O,{label:$.$t("database.isOn")},{default:a(()=>[e(U,{modelValue:p.slow_query_log,"onUpdate:modelValue":y[0]||(y[0]=j=>p.slow_query_log=j),"active-value":"ON","inactive-value":"OFF",onChange:o},null,8,["modelValue"])]),_:1},8,["label"]),r.value?(N(),F(O,{key:0,label:$.$t("database.longQueryTime")},{default:a(()=>[i("div",kt,[e(g,{type:"number",modelValue:p.long_query_time,"onUpdate:modelValue":y[1]||(y[1]=j=>p.long_query_time=j),modelModifiers:{number:!0}},null,8,["modelValue"])]),e(X,{style:{float:"left","margin-left":"10px"},onClick:f},{default:a(()=>[V(n($.$t("commons.button.save")),1)]),_:1}),i("div",Vt,[e(te,{style:{"margin-top":"2px"},disabled:!l.value,border:"",modelValue:S.value,"onUpdate:modelValue":y[2]||(y[2]=j=>S.value=j)},{default:a(()=>[V(n($.$t("commons.button.watch")),1)]),_:1},8,["disabled","modelValue"])]),e(X,{disabled:!l.value,style:{"margin-left":"20px"},onClick:D,icon:"Download"},{default:a(()=>[V(n($.$t("file.download")),1)]),_:1},8,["disabled"])]),_:1},8,["label"])):K("",!0)]),_:1}),e(_(Ke),{autofocus:!0,placeholder:$.$t("database.noData"),"indent-with-tab":!0,tabSize:4,style:{height:"calc(100vh - 428px)",width:"100%"},lineWrapping:!0,matchBrackets:!0,theme:"cobalt",styleActiveLine:!0,extensions:h,onReady:C,modelValue:v.value,"onUpdate:modelValue":y[3]||(y[3]=j=>v.value=j),disabled:!0},null,8,["placeholder","modelValue"]),Ct,e(ue,{onCancle:q,ref_key:"confirmDialogRef",ref:P,onConfirm:B},null,512)])}}}),Pt={key:0},St=i("br",null,null,-1),Nt=x({__name:"index",setup(E,{expose:H}){const u=c(!1),h=c(),v=[Ee(),Oe],t=c("conf"),C=J({name:"",port:3306,password:"",remoteConn:!1,containerID:""}),r=c(),l=c(),P=c(!1),S=c(),b=c(),d=c(),p=c(!1),z=c(),o=c(),f=c(),q=c(),B=c(),D=s=>{p.value=!0,o.value=s.status,f.value=s.mysqlVersion,me(),o.value==="Running"&&(Ve(),be(),S.value.acceptParams({mysqlName:s.mysqlName}))},w=()=>{p.value=!1},$=async()=>{t.value="conf";const s=await Pe();ve(`${s.data}/apps/mysql/${z.value}/conf/my.cnf`)},y=async()=>{t.value="slowLog",be()},U=async()=>{let s={key:"mysql",name:z.value,port:C.port};u.value=!0,await Ia(s).then(()=>{u.value=!1,W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{u.value=!1})},O=c(),g=async s=>{if(!s||!await s.validateField("port",X))return;let M={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};O.value.acceptParams(M)};function X(s){if(s)return s.message}const te=async()=>{u.value=!0;const s=await Ha("mysql");l.value=s.data,P.value=!0,u.value=!1},L=async()=>{let s={mysqlName:z.value,file:l.value};u.value=!0,await Ca(s).then(()=>{P.value=!1,u.value=!1,W(k.global.t("commons.msg.operationSuccess"))}).catch(()=>{u.value=!1})},j=c(),$e=async()=>{let s={header:k.global.t("database.confChange"),operationInfo:k.global.t("database.restartNowHelper"),submitInputInfo:k.global.t("database.restartNow")};j.value.acceptParams(s)},ke=async s=>{B.value.acceptParams({containerID:s,container:z.value})},me=async()=>{var M,ie,Z;const s=await qa();z.value=(M=s.data)==null?void 0:M.name,C.port=(ie=s.data)==null?void 0:ie.port,C.containerID=(Z=s.data)==null?void 0:Z.containerName;const m=await Pe();h.value=m.data,ve(`${m.data}/apps/mysql/${z.value}/conf/my.cnf`),ke(C.containerID)},fe=s=>{u.value=s},Ve=async()=>{const s=await Be();q.value=s.data,b.value.acceptParams({mysqlName:z.value,mysqlVersion:f.value,variables:s.data})},be=async()=>{const s=await Be();q.value=s.data;let m={mysqlName:z.value,variables:q.value};d.value.acceptParams(m)},ve=async s=>{P.value=!1;const m=await We({path:s});u.value=!1,l.value=m.data};return H({acceptParams:D,onClose:w}),(s,m)=>{const M=le,ie=Ie,Z=ne,he=ae,re=oe,ye=ee,pe=Y,Ce=de;return G((N(),A("div",null,[e(Le,{title:"MySQL "+s.$t("database.setting"),reload:!0},{buttons:a(()=>[e(M,{type:"primary",plain:t.value!=="conf",onClick:$},{default:a(()=>[V(n(s.$t("database.confChange")),1)]),_:1},8,["plain"]),e(M,{type:"primary",disabled:o.value!=="Running",plain:t.value!=="status",onClick:m[0]||(m[0]=Q=>t.value="status")},{default:a(()=>[V(n(s.$t("database.currentStatus")),1)]),_:1},8,["disabled","plain"]),e(M,{type:"primary",disabled:o.value!=="Running",plain:t.value!=="tuning",onClick:m[1]||(m[1]=Q=>t.value="tuning")},{default:a(()=>[V(n(s.$t("database.performanceTuning")),1)]),_:1},8,["disabled","plain"]),e(M,{type:"primary",plain:t.value!=="port",onClick:m[2]||(m[2]=Q=>t.value="port")},{default:a(()=>[V(n(s.$t("database.portSetting")),1)]),_:1},8,["plain"]),e(M,{type:"primary",disabled:o.value!=="Running",plain:t.value!=="log",onClick:m[3]||(m[3]=Q=>t.value="log")},{default:a(()=>[V(n(s.$t("database.log")),1)]),_:1},8,["disabled","plain"]),e(M,{type:"primary",disabled:o.value!=="Running",onClick:y,plain:t.value!=="slowLog"},{default:a(()=>[V(n(s.$t("database.slowLog")),1)]),_:1},8,["disabled","plain"])]),main:a(()=>[t.value==="conf"?(N(),A("div",Pt,[e(_(Ke),{autofocus:!0,placeholder:"None data","indent-with-tab":!0,tabSize:4,style:{"margin-top":"10px",height:"calc(100vh - 375px)"},lineWrapping:!0,matchBrackets:!0,theme:"cobalt",styleActiveLine:!0,extensions:v,modelValue:l.value,"onUpdate:modelValue":m[4]||(m[4]=Q=>l.value=Q)},null,8,["modelValue"]),e(M,{style:{"margin-top":"10px"},onClick:m[5]||(m[5]=Q=>te())},{default:a(()=>[V(n(s.$t("app.defaultConfig")),1)]),_:1}),e(M,{type:"primary",style:{"margin-top":"10px"},onClick:$e},{default:a(()=>[V(n(s.$t("commons.button.save")),1)]),_:1}),e(he,null,{default:a(()=>[e(Z,{span:8},{default:a(()=>[P.value?(N(),F(ie,{key:0,style:{"margin-top":"10px"},title:s.$t("app.defaultConfigHelper"),type:"info",closable:!1},null,8,["title"])):K("",!0)]),_:1})]),_:1})])):K("",!0),G(e(ot,{ref_key:"statusRef",ref:S},null,512),[[_e,t.value==="status"]]),G(e($t,{onLoading:fe,ref_key:"variablesRef",ref:b},null,512),[[_e,t.value==="tuning"]]),G(i("div",null,[e(pe,{model:C,ref_key:"panelFormRef",ref:r,"label-position":"top"},{default:a(()=>[e(he,null,{default:a(()=>[e(Z,{span:1},{default:a(()=>[St]),_:1}),e(Z,{span:10},{default:a(()=>[e(ye,{label:s.$t("setting.port"),prop:"port",rules:_(I).port},{default:a(()=>[e(re,{clearable:"",type:"number",modelValue:C.port,"onUpdate:modelValue":m[6]||(m[6]=Q=>C.port=Q),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(ye,null,{default:a(()=>[e(M,{type:"primary",onClick:m[7]||(m[7]=Q=>g(r.value)),icon:"Collection"},{default:a(()=>[V(n(s.$t("commons.button.save")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])],512),[[_e,t.value==="port"]]),G(e(Da,{ref_key:"dialogContainerLogRef",ref:B},null,512),[[_e,t.value==="log"]]),G(e(qt,{onLoading:fe,onRefresh:me,ref_key:"slowLogRef",ref:d},null,512),[[_e,t.value==="slowLog"]])]),_:1},8,["title"]),e(ue,{ref_key:"confirmPortRef",ref:O,onConfirm:U},null,512),e(ue,{ref_key:"confirmConfRef",ref:j,onConfirm:L},null,512)])),[[_e,p.value],[Ce,u.value]])}}}),Rt={class:"search-button"},It={key:0,style:{float:"left","line-height":"25px"}},Ht={key:1,style:{cursor:"pointer",float:"left"}},Bt={key:2,style:{float:"left"}},Dt={key:3,style:{cursor:"pointer",float:"left"}},Ut={style:{cursor:"pointer",float:"left"}},Mt={class:"dialog-footer"},Cs=x({__name:"index",setup(E){const H=c(!1),u=c(!0),h=c(),v=c(),t=c(),C=c(),r=c(),l=c(!1),P=c(),S=J({currentPage:1,pageSize:10,total:0}),b=c(),d=c(!1),p=c(),z=c(),o=c(),f=c(),q=async()=>{let s={mysqlName:h.value};f.value.acceptParams(s)},B=c(),D=async s=>{let m={type:"mysql",name:h.value,detailName:s};B.value.acceptParams(m)},w=c(),$=c(),y=async()=>{$.value.acceptParams()},U=c(),O=async()=>{let m={privilege:(await Pa()).data};U.value.acceptParams(m)},g=c(),X=c(),te=async()=>{v.value=!0;let s={status:z.value,mysqlName:h.value,mysqlVersion:o.value};X.value.acceptParams(s)},L=async()=>{let s={page:S.currentPage,pageSize:S.pageSize,info:b.value};const m=await Sa(s);P.value=m.data.items||[],S.total=m.data.total},j=async s=>{s.edit||(await Na({id:s.id,description:s.description}),W(k.global.t("commons.msg.operationSuccess")))},$e=async()=>{if(r.value===0){l.value=!0;return}let m=window.location.href.split("//")[1].split(":")[0];window.open(`http://${m}:${r.value}`,"_blank")},ke=s=>{za.push({name:"AppDetail",params:{appKey:s}})},me=async()=>{const s=await Ba("phpmyadmin");r.value=s.data},fe=s=>{d.value=s.isExist,h.value=s.name,z.value=s.status,o.value=s.version,p.value=s.containerName,d.value&&(L(),me())},Ve=s=>{let m=document.createElement("input");m.value=s.password,document.body.appendChild(m),m.select(),document.execCommand("Copy"),document.body.removeChild(m),W(k.global.t("commons.msg.copySuccess"))},be=async s=>{const m=await je(s.id);m.data&&m.data.length>0?t.value.acceptParams({items:m.data}):C.value.acceptParams({id:s.id,name:s.name})},ve=[{label:k.global.t("database.changePassword"),click:s=>{let m={id:s.id,operation:"password",username:s.username,password:s.password};g.value.acceptParams(m)}},{label:k.global.t("database.permission"),click:s=>{let m={id:s.id,operation:"privilege",privilege:"",privilegeIPs:"",password:""};s.permission==="%"?m.privilege=s.permission:(m.privilegeIPs=s.permission,m.privilege="ip"),g.value.acceptParams(m)}},{label:k.global.t("database.backupList"),click:s=>{D(s.name)}},{label:k.global.t("database.loadBackup"),click:s=>{let m={type:"mysql",name:h.value,detailName:s.name};w.value.acceptParams(m)}},{label:k.global.t("commons.button.delete"),click:s=>{be(s)}}];return(s,m)=>{const M=le,ie=ne,Z=oe,he=ae,re=fa,ye=ce("View"),pe=ba,Ce=ce("Hide"),Q=ce("DocumentCopy"),Qe=ce("fu-read-write-switch"),Je=ce("fu-table-operations"),xe=va,Xe=ha,Ye=Ie,Ze=Re,ea=de;return G((N(),A("div",null,[e(Le,{title:"MySQL "+s.$t("menu.database")},ya({app:a(()=>[e(Fa,{"app-key":"mysql",loading:H.value,"onUpdate:loading":m[0]||(m[0]=R=>H.value=R),"mask-show":u.value,"onUpdate:mask-show":m[1]||(m[1]=R=>u.value=R),onSetting:te,onIsExist:fe},null,8,["loading","mask-show"])]),_:2},[d.value&&!v.value?{name:"toolbar",fn:a(()=>[e(he,{class:He({mask:z.value!="Running"})},{default:a(()=>[e(ie,{span:20},{default:a(()=>[e(M,{type:"primary",onClick:m[2]||(m[2]=R=>q())},{default:a(()=>[V(n(s.$t("database.create")),1)]),_:1}),e(M,{onClick:y,type:"primary",plain:""},{default:a(()=>[V(n(s.$t("database.rootPassword")),1)]),_:1}),e(M,{onClick:O,type:"primary",plain:""},{default:a(()=>[V(n(s.$t("database.remoteAccess")),1)]),_:1}),e(M,{onClick:$e,type:"primary",plain:""},{default:a(()=>[V("phpMyAdmin")]),_:1})]),_:1}),e(ie,{span:4},{default:a(()=>[i("div",Rt,[e(Z,{modelValue:b.value,"onUpdate:modelValue":m[3]||(m[3]=R=>b.value=R),clearable:"",onClear:m[4]||(m[4]=R=>L()),"suffix-icon":"Search",onKeyup:m[5]||(m[5]=ga(R=>L(),["enter"])),onBlur:m[6]||(m[6]=R=>L()),placeholder:s.$t("commons.button.search")},null,8,["modelValue","placeholder"])])]),_:1})]),_:1},8,["class"])]),key:"0"}:void 0,d.value&&!v.value?{name:"main",fn:a(()=>[e(wa,{"pagination-config":S,onSearch:L,data:P.value,class:He({mask:z.value!="Running"})},{default:a(()=>[e(re,{label:s.$t("commons.table.name"),prop:"name"},null,8,["label"]),e(re,{label:s.$t("commons.login.username"),prop:"username"},null,8,["label"]),e(re,{label:s.$t("commons.login.password"),prop:"password"},{default:a(({row:R})=>[i("div",null,[R.showPassword?K("",!0):(N(),A("span",It,"***********")),R.showPassword?K("",!0):(N(),A("div",Ht,[e(pe,{style:{"margin-left":"5px","margin-top":"3px"},onClick:se=>R.showPassword=!0,size:16},{default:a(()=>[e(ye)]),_:2},1032,["onClick"])])),R.showPassword?(N(),A("span",Bt,n(R.password),1)):K("",!0),R.showPassword?(N(),A("div",Dt,[e(pe,{style:{"margin-left":"5px","margin-top":"3px"},onClick:se=>R.showPassword=!1,size:16},{default:a(()=>[e(Ce)]),_:2},1032,["onClick"])])):K("",!0),i("div",Ut,[e(pe,{style:{"margin-left":"5px","margin-top":"3px"},size:16,onClick:se=>Ve(R)},{default:a(()=>[e(Q)]),_:2},1032,["onClick"])])])]),_:1},8,["label"]),e(re,{label:s.$t("commons.table.description"),prop:"description"},{default:a(({row:R})=>[e(Qe,{data:R.description,modelValue:R.edit,"onUpdate:modelValue":se=>R.edit=se,onChange:se=>j(R)},{default:a(()=>[e(Z,{modelValue:R.description,"onUpdate:modelValue":se=>R.description=se,onBlur:se=>R.edit=!1},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["data","modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),e(re,{prop:"createdAt",label:s.$t("commons.table.date"),formatter:_(Ma),"show-overflow-tooltip":""},null,8,["label","formatter"]),e(Je,{width:"370px",buttons:ve,ellipsis:10,label:s.$t("commons.table.operate"),fix:""},null,8,["label"])]),_:1},8,["pagination-config","data","class"])]),key:"1"}:void 0]),1032,["title"]),z.value!="Running"&&!v.value&&d.value&&!H.value&&u.value?(N(),F(xe,{key:0,class:"mask-prompt"},{default:a(()=>[i("span",null,n(s.$t("commons.service.serviceNotStarted",["MySQL"])),1)]),_:1})):K("",!0),e(Nt,{ref_key:"settingRef",ref:X,style:{"margin-top":"20px"}},null,512),e(Ze,{modelValue:l.value,"onUpdate:modelValue":m[9]||(m[9]=R=>l.value=R),title:s.$t("app.checkTitle"),width:"30%","close-on-click-modal":!1,"destroy-on-close":!0},{footer:a(()=>[i("span",Mt,[e(M,{onClick:m[8]||(m[8]=R=>l.value=!1)},{default:a(()=>[V(n(s.$t("commons.button.cancel")),1)]),_:1})])]),default:a(()=>[e(Ye,{closable:!1,title:s.$t("app.checkInstalledWarn",["phpMyAdmin"]),type:"info"},{default:a(()=>[e(Xe,{icon:"Position",onClick:m[7]||(m[7]=R=>ke("phpmyadmin")),type:"primary"},{default:a(()=>[V(n(s.$t("database.goInstall")),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue","title"]),e(Za,{ref_key:"passwordRef",ref:g,onSearch:L},null,512),e(al,{ref_key:"rootPasswordRef",ref:$},null,512),e(sl,{ref_key:"remoteAccessRef",ref:U},null,512),e(La,{ref_key:"uploadRef",ref:w},null,512),e(Aa,{onSearch:L,ref_key:"dialogRef",ref:f},null,512),e(ja,{ref_key:"dialogBackupRef",ref:B},null,512),e(nl,{ref_key:"checkRef",ref:t},null,512),e(Ja,{ref_key:"deleteRef",ref:C,onSearch:L},null,512)])),[[ea,H.value]])}}});export{Cs as default};
