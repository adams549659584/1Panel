import{d as P,r as u,x as D,b as R,c as I,w as l,e,f as h,g as y,t as b,Y as F,y as O,a3 as X,$ as Y,j as B,a1 as T,a2 as x,K as G,L as Q,l as q,m as K,A as M,af as W,a5 as j,o as Z,C as ee,aq as ae,h as te,O as oe,ae as le,a6 as ne,V as se,X as re}from"./index-609fd921.js";/* empty css                *//* empty css                     *//* empty css                 *//* empty css            *//* empty css            *//* empty css              *//* empty css             *//* empty css               */import{_ as ie}from"./layout-content-47227111.js";import{_ as me}from"./index-f10fbc50.js";import{_ as ue}from"./index-af1c8b2d.js";import{T as pe}from"./index-7cc1b133.js";import{_ as de}from"./index-110fbc44.js";/* empty css                *//* empty css               *//* empty css               */import"./form-item-d76e7d20.js";import{R as z}from"./form-rules-08616160.js";import{v as ce,l as fe,w as ve,i as be,x as _e}from"./container-94920957.js";import{_ as ge}from"./codemirror-6ae37f99.js";import{b as $e}from"./util-bdb43d7e.js";import{u as Se}from"./use-delete-data-3fb8ebbf.js";/* empty css                    */import"./tooltip-b30db216.js";/* empty css                *//* empty css               */import"./index-e09fb15b.js";import"./index-5eb40136.js";const ye={class:"dialog-footer"},Ve=P({__name:"index",emits:["search"],setup(A,{expose:d,emit:V}){const c=u(!1),f=u(!1),t=D({name:"",driver:"local",labelStr:"",labels:[],optionStr:"",options:[]}),_=()=>{t.name="",t.labels=[],t.labelStr="",t.options=[],t.optionStr="",f.value=!0},$=()=>{f.value=!1},v=D({name:[z.requiredInput,z.volumeName],driver:[z.requiredSelect]}),w=u(),E=async s=>{!s||s.validate(async n=>{!n||(t.labelStr!==""&&(t.labels=t.labelStr.split(`
`)),t.optionStr!==""&&(t.options=t.optionStr.split(`
`)),c.value=!0,await ce(t).then(()=>{c.value=!1,Y(B.global.t("commons.msg.operationSuccess")),V("search"),f.value=!1}).catch(()=>{c.value=!1}))})};return d({acceptParams:_}),(s,n)=>{const i=T,g=x,C=G,N=Q,o=q,a=K,p=M,U=W,k=j;return R(),I(U,{modelValue:f.value,"onUpdate:modelValue":n[6]||(n[6]=r=>f.value=r),"destroy-on-close":!0,"close-on-click-modal":!1,size:"50%"},{header:l(()=>[e(de,{header:s.$t("container.createVolume"),back:$},null,8,["header"])]),footer:l(()=>[h("span",ye,[e(p,{disabled:c.value,onClick:n[4]||(n[4]=r=>f.value=!1)},{default:l(()=>[y(b(s.$t("commons.button.cancel")),1)]),_:1},8,["disabled"]),e(p,{disabled:c.value,type:"primary",onClick:n[5]||(n[5]=r=>E(w.value))},{default:l(()=>[y(b(s.$t("commons.button.confirm")),1)]),_:1},8,["disabled"])])]),default:l(()=>[e(a,{type:"flex",justify:"center"},{default:l(()=>[e(o,{span:22},{default:l(()=>[F((R(),I(O(X),{ref_key:"formRef",ref:w,"label-position":"top",model:t,rules:v,"label-width":"80px"},{default:l(()=>[e(g,{label:s.$t("container.volumeName"),prop:"name"},{default:l(()=>[e(i,{clearable:"",modelValue:t.name,"onUpdate:modelValue":n[0]||(n[0]=r=>t.name=r),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),e(g,{label:s.$t("container.driver"),prop:"driver"},{default:l(()=>[e(N,{modelValue:t.driver,"onUpdate:modelValue":n[1]||(n[1]=r=>t.driver=r)},{default:l(()=>[e(C,{label:"local",value:"local"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(g,{label:s.$t("container.option"),prop:"optionStr"},{default:l(()=>[e(i,{type:"textarea",placeholder:s.$t("container.tagHelper"),autosize:{minRows:2,maxRows:4},modelValue:t.optionStr,"onUpdate:modelValue":n[2]||(n[2]=r=>t.optionStr=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),e(g,{label:s.$t("container.tag"),prop:"labelStr"},{default:l(()=>[e(i,{type:"textarea",placeholder:s.$t("container.tagHelper"),autosize:{minRows:2,maxRows:4},modelValue:t.labelStr,"onUpdate:modelValue":n[3]||(n[3]=r=>t.labelStr=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[k,c.value]])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),we={class:"search-button"},ea=P({__name:"index",setup(A){const d=u(),V=u(),c=u(),f=u(),t=u([]),_=D({currentPage:1,pageSize:10,total:0}),$=u(),v=u("Running"),w=async()=>{d.value=!0,await fe().then(o=>{d.value=!1,v.value=o.data,v.value==="Running"&&i()}).catch(()=>{v.value="Failed",d.value=!1})},E=async()=>{se.push({name:"ContainerSetting"})},s=u(),n=async()=>{s.value.acceptParams()},i=async()=>{const o={info:$.value,page:_.currentPage,pageSize:_.pageSize};d.value=!0,await ve(o).then(a=>{d.value=!1,f.value=a.data.items||[],_.total=a.data.total}).catch(()=>{d.value=!1})},g=async o=>{const a=await be({id:o,type:"volume"});V.value=JSON.stringify(JSON.parse(a.data),null,2);let p={header:B.global.t("commons.button.view"),detailInfo:V.value};c.value.acceptParams(p)},C=async o=>{let a=[];o===null?t.value.forEach(p=>{a.push(p.name)}):a.push(o.name),await Se(_e,{names:a},"commons.msg.delete"),i()},N=[{label:B.global.t("commons.button.delete"),click:o=>{C(o)}}];return Z(()=>{w()}),(o,a)=>{const p=M,U=ee,k=q,r=T,H=K,S=ae,J=re("fu-table-operations"),L=j;return F((R(),te("div",null,[v.value!="Running"?(R(),I(U,{key:0,class:"mask-prompt"},{default:l(()=>[h("span",null,b(o.$t("container.serviceUnavailable")),1),e(p,{type:"primary",link:"",class:"bt",onClick:E},{default:l(()=>[y("\u3010 "+b(o.$t("container.setting"))+" \u3011",1)]),_:1}),h("span",null,b(o.$t("container.startIn")),1)]),_:1})):oe("",!0),e(ie,{title:o.$t("container.volume"),class:ne({mask:v.value!="Running"})},{toolbar:l(()=>[e(H,null,{default:l(()=>[e(k,{span:16},{default:l(()=>[e(p,{type:"primary",onClick:a[0]||(a[0]=m=>n())},{default:l(()=>[y(b(o.$t("container.createVolume")),1)]),_:1}),e(p,{type:"primary",plain:"",disabled:t.value.length===0,onClick:a[1]||(a[1]=m=>C(null))},{default:l(()=>[y(b(o.$t("commons.button.delete")),1)]),_:1},8,["disabled"])]),_:1}),e(k,{span:8},{default:l(()=>[e(pe,{onSearch:a[2]||(a[2]=m=>i())}),h("div",we,[e(r,{modelValue:$.value,"onUpdate:modelValue":a[3]||(a[3]=m=>$.value=m),clearable:"",onClear:a[4]||(a[4]=m=>i()),"suffix-icon":"Search",onKeyup:a[5]||(a[5]=le(m=>i(),["enter"])),onBlur:a[6]||(a[6]=m=>i()),placeholder:o.$t("commons.button.search")},null,8,["modelValue","placeholder"])])]),_:1})]),_:1})]),main:l(()=>[e(ue,{"pagination-config":_,selects:t.value,"onUpdate:selects":a[7]||(a[7]=m=>t.value=m),data:f.value,onSearch:i},{default:l(()=>[e(S,{type:"selection",fix:""}),e(S,{label:o.$t("commons.table.name"),"min-width":"80",prop:"name",fix:""},{default:l(({row:m})=>[e(me,{onClick:Ce=>g(m.name),text:m.name},null,8,["onClick","text"])]),_:1},8,["label"]),e(S,{label:o.$t("container.mountpoint"),"show-overflow-tooltip":"","min-width":"120",prop:"mountpoint"},null,8,["label"]),e(S,{label:o.$t("container.driver"),"show-overflow-tooltip":"","min-width":"80",prop:"driver"},null,8,["label"]),e(S,{prop:"createdAt","min-width":"90",label:o.$t("commons.table.date"),formatter:O($e)},null,8,["label","formatter"]),e(J,{buttons:N,label:o.$t("commons.table.operate"),fix:""},null,8,["label"])]),_:1},8,["pagination-config","selects","data"])]),_:1},8,["title","class"]),e(ge,{ref_key:"codemirror",ref:c},null,512),e(Ve,{onSearch:i,ref_key:"dialogCreateRef",ref:s},null,512)])),[[L,d.value]])}}});export{ea as default};
