import{d as z,r as y,b as n,c as m,w as o,e as d,g as c,t as u,h as k,O as i,y as A,f as D,$ as b,j as $,A as L,a1 as M,a2 as O,a3 as P,aq as H,af as J}from"./index-9eeac04e.js";import{_ as K}from"./index-bb4c3e65.js";/* empty css                *//* empty css                     *//* empty css                 *//* empty css            *//* empty css             */import"./form-item-d76e7d20.js";/* empty css              *//* empty css               */import{_ as Q}from"./index-8d9ad139.js";import{G as W,C as X,U as V,D as Y}from"./group-e1575ac2.js";import{R as Z}from"./form-rules-028b05ac.js";const w={key:0},x={key:0},ee={key:1},te={key:2},ae={style:{"margin-top":"20px",width:"100%"}},ye=z({__name:"index",emits:["search"],setup(le,{expose:G,emit:S}){const p=y(!1),f=y(),s=y(),h=()=>{p.value=!1,s.value=[],S("search")},C=y(),E=e=>{f.value=e.type,p.value=!0,r()},r=()=>{s.value=[],W({type:f.value}).then(e=>{for(const t of e.data){const l={id:t.id,name:t.name,isDefault:t.isDefault,edit:!1};s.value.push(l)}})},B=async(e,t)=>{!e||await e.validate(l=>{!l||(t.type=f.value,t.id==0?X(t).then(()=>{b($.global.t("commons.msg.createSuccess")),r()}):V(t).then(()=>{b($.global.t("commons.msg.updateSuccess")),r()}))})},N=e=>{e.isDefault=!0,e.type=f.value,V(e).then(()=>{b($.global.t("commons.msg.updateSuccess")),r()})},U=()=>{for(const t of s.value){if(t.name=="")return;t.edit&&(t.edit=!1)}const e={id:0,name:"",isDefault:!1,edit:!0};s.value.unshift(e)},F=e=>{const t=s.value[e];t.id>0?Y(t.id).then(()=>{s.value.splice(e,1),b($.global.t("commons.msg.deleteSuccess"))}):s.value.splice(e,1)},I=e=>{for(const t in s.value){const l=s.value[t];l.name==""&&s.value.splice(Number(t),1),l.edit&&(l.edit=!1)}s.value[e].edit=!0};return G({acceptParams:E}),(e,t)=>{const l=L,R=M,T=O,j=P,g=H,q=J;return n(),m(q,{"close-on-click-modal":!1,modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=a=>p.value=a),size:"50%","before-close":h},{header:o(()=>[d(K,{header:e.$t("website.group"),back:h},null,8,["header"])]),default:o(()=>[d(Q,{data:s.value,onSearch:t[1]||(t[1]=a=>r())},{toolbar:o(()=>[d(l,{type:"primary",onClick:U},{default:o(()=>[c(u(e.$t("website.createGroup")),1)]),_:1})]),default:o(()=>[d(g,{label:e.$t("commons.table.name"),prop:"name"},{default:o(({row:a})=>[a.edit?i("",!0):(n(),k("div",w,[a.name==="default"?(n(),k("span",x,u(e.$t("website.default")),1)):i("",!0),a.name!=="default"?(n(),k("span",ee,u(a.name),1)):i("",!0),a.isDefault?(n(),k("span",te,"("+u(e.$t("website.default"))+")",1)):i("",!0)])),a.edit?(n(),m(j,{key:1,ref_key:"groupForm",ref:C,model:a},{default:o(()=>[a.edit?(n(),m(T,{key:0,prop:"name",rules:A(Z).name},{default:o(()=>[D("div",ae,[d(R,{modelValue:a.name,"onUpdate:modelValue":_=>a.name=_},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["rules"])):i("",!0)]),_:2},1032,["model"])):i("",!0)]),_:1},8,["label"]),d(g,{label:e.$t("commons.table.operate")},{default:o(({row:a,$index:_})=>[D("div",null,[a.edit?(n(),m(l,{key:0,link:"",type:"primary",onClick:v=>B(C.value,a)},{default:o(()=>[c(u(e.$t("commons.button.save")),1)]),_:2},1032,["onClick"])):i("",!0),a.edit?i("",!0):(n(),m(l,{key:1,link:"",type:"primary",onClick:v=>I(_)},{default:o(()=>[c(u(e.$t("commons.button.edit")),1)]),_:2},1032,["onClick"])),a.edit?i("",!0):(n(),m(l,{key:2,link:"",disabled:a.isDefault,type:"primary",onClick:v=>F(_)},{default:o(()=>[c(u(e.$t("commons.button.delete")),1)]),_:2},1032,["disabled","onClick"])),a.edit?(n(),m(l,{key:3,link:"",type:"primary",onClick:t[0]||(t[0]=v=>r())},{default:o(()=>[c(u(e.$t("commons.button.cancel")),1)]),_:1})):i("",!0),!a.edit&&!a.isDefault?(n(),m(l,{key:4,link:"",type:"primary",onClick:v=>N(a)},{default:o(()=>[c(u(e.$t("website.setDefault")),1)]),_:2},1032,["onClick"])):i("",!0)])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["modelValue"])}}});export{ye as _};
